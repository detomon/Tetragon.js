!function(a){for(var b=0,c=["webkit","moz"],d=0;d<c.length&&!a.requestAnimationFrame;++d)a.requestAnimationFrame=a[c[d]+"RequestAnimationFrame"],a.cancelAnimationFrame=a[c[d]+"CancelAnimationFrame"]||a[c[d]+"CancelRequestAnimationFrame"];a.requestAnimationFrame||(a.requestAnimationFrame=function(c,d){var e=(new Date).getTime(),f=Math.max(0,16-(e-b)),g=a.setTimeout(function(){c(e+f)},f);return b=e+f,g}),a.cancelAnimationFrame||(a.cancelAnimationFrame=function(a){clearTimeout(a)})}(window),function(a){"use strict";a.Tetragon=a.Tetragon||{},a.Tetragon.version="0.1.0"}(window),function(a){"use strict";var b=a.Vector=function(a,b){this.x=parseFloat(a)||0,this.y=parseFloat(b)||0},c=b.prototype;c.add=function(a){return new b(this.x+a.x,this.y+a.y)},c.sub=function(a){return new b(this.x-a.x,this.y-a.y)},c.inc=function(a){this.x+=a.x,this.y+=a.y},c.dec=function(a){this.x-=a.x,this.y-=a.y},c.shl=function(a){return new b(this.x<<a,this.y<<a)},c.shr=function(a){return new b(this.x>>a,this.y>>a)},c.integ=function(a){return new b(0|this.x,0|this.y)},c.mult=function(a){return new b(this.x*a,this.y*a)},c.div=function(a){return new b(this.x/a,this.y/a)},c.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},c.lengthSquared=function(){return this.x*this.x+this.y*this.y},c.normalize=function(a){void 0===a&&(a=1);var c=this.x,d=this.y,e=this.length();return e&&(e=a/e),c*=e,d*=e,new b(c,d)},c.multVec=function(a){return new b(this.x*a.x,this.y*a.y)},c.divVec=function(a){return new b(this.x/a.x,this.y/a.y)},c.dot=function(a){return this.x*a.x+this.y*a.y},c.reflect=function(a){return a=a.normalize(),this.sub(a.mult(2*a.dot(this)))},c.negate=function(a){return new b(-this.x,-this.y)},c.copy=function(){return new b(this.x,this.y)},c.rotate=function(a){var c=a/180*Math.PI,d=Math.cos(c),e=Math.sin(c),f=this.x*d-this.y*e,g=this.x*e+this.y*d;return new b(f,g)},c.copy=function(a){return new b(this.x,this.y)}}(Tetragon),function(a){"use strict";var b=a.AnimationLoop=function(a){this.framerate=a,this.lastTime=0},c=b.prototype;c.advanceToTime=function(a,b){for(0==this.lastTime&&(this.lastTime=a-1/60),this.lastTime=Math.max(a-.05,this.lastTime),a-=this.framerate;this.lastTime<a;)b(this.framerate),this.lastTime+=this.framerate}}(Tetragon),function(a){"use strict";var b=a.Controls=function(){this.keys=0};b.LEFT=1,b.TOP=2,b.RIGHT=4,b.BOTTOM=8,b.keyMap={37:b.LEFT,38:b.TOP,39:b.RIGHT,40:b.BOTTOM,65:b.LEFT,87:b.TOP,68:b.RIGHT,83:b.BOTTOM};var c=b.prototype;c.pressKeyWithCode=function(a){b.keyMap[a]&&(this.keys|=b.keyMap[a])},c.releaseKeyWithCode=function(a){b.keyMap[a]&&(this.keys&=~b.keyMap[a])},c.isKeyPressed=function(a){return this.keys&a},c.reset=function(){this.keys=0}}(Tetragon),function(a){"use strict";var b=a.EntityComponent=function(a,b){this.id=a,this.name=b.name,this.options=b,this.createInstance=b.createInstance,this.data=[]},c=b.prototype;c.iterate=function(a){var b,c=Array.prototype.slice.call(arguments,1);"string"==typeof a&&(a=this.options[a]);for(b in this.data)this.data.hasOwnProperty(b)&&a.apply(this.data[b],c)}}(Tetragon),function(a){"use strict";var b=a.EntitySystem=function(){this.entities=[],this.freeEntites=[],this.components=[],this.namedComponents={}},c=b.prototype;c.component=function(a){return this.namedComponents[a]},c.createComponent=function(b){var c=this.components.length,d=new a.EntityComponent(c,b);return this.components.push(d),this.namedComponents[d.name]=d,d},c.entity=function(a){return void 0===this.entities[a]?null:new Entity(a,this)},c.createEntity=function(){var b=this.freeEntites.pop();return void 0===b&&(b=this.entities.length+1,this.entities.push(0)),new a.Entity(b,this)},c.iterate=function(a,b){var c=Array.prototype.slice.call(arguments,2),d=this.component(a);d&&(c.unshift(b),d.iterate.apply(d,c))}}(Tetragon),function(a){"use strict";var b=a.Entity=function(a,b){this.id=a,this.system=b},c=b.prototype;c.addComponent=function(a){var b=Array.prototype.slice.call(arguments,1);if("string"==typeof a&&(a=this.system.component(a),!a))return null;if(a.data[this.id-1])return null;var c;return c=a.createInstance?a.createInstance.apply(this,b):{},c.entity=this,a.data[this.id-1]=c,this.system.entities[this.id-1]|=1<<a.id,c},c.removeComponent=function(a){return("string"!=typeof a||(a=this.system.component(a)))&&a.data[this.id-1]?(delete a.data[this.id-1],this.system.entities[this.id-1]&=~(1<<a.id),instance):null},c.componentData=function(a){var b=this.system.namedComponents[a];return b?b.data[this.id-1]:null},c["delete"]=function(){var a=0,b=this.system;if(void 0!==b.entities[this.id-1]){for(var c=b.entities[this.id-1];c;){if(255&c||(c>>=8,a+=8),1&c){var d=b.components[a];delete d.data[this.id-1]}c>>=1,a++}delete b.entities[this.id-1],b.freeEntites.push(this.id)}}}(Tetragon),function(a){"use strict";a.extend=function(a,b){var c,d,e,f=Array.prototype.slice.call(arguments,1);for(c=0;c<f.length;c++){var e=f[c];for(d in e)e.hasOwnProperty(d)&&null!==e[d]&&void 0!==e[d]&&(a[d]=e[d])}return a},a.reduce=function(a,b,c){var d,e=b;for(d=0;d<a.length;d++)e=c(e,a[d]);return e},a.loadImages=function(b,c){function d(a){var d=new Image;return d.onload=function(){g[a]||(g[a]=d,c.load&&c.load(d),++f>=b.length&&c.done&&c.done(g))},d.src=a,d}var e,c=c||{},f=0,g={};for(c=a.extend({done:null,load:null},c),0==b.length&&c.done&&c.done(g),e=0;e<b.length;e++){var h=b[e];h===Object(h)&&(h=h.src),d(h)}}}(Tetragon),function(a){"use strict";var b=a.Matrix=function(a){a?this.set(a):this.set([1,0,0,1,0,0])},c=b.prototype;c.translate=function(a){return this[4]+=a.x*this[0]+a.y*this[2],this[5]+=a.x*this[1]+a.y*this[3],this},c.scale=function(a){return this[0]*=a.x,this[2]*=a.x,this[1]*=a.y,this[3]*=a.y,this},c.rotate=function(b){var c,d;b=b/180*Math.PI,c=Math.sin(b),d=Math.cos(b);var e=this.multiply(new a.Matrix([d,c,-c,d,0,0]));return this.set(e),this},c.multVec=function(b){return new a.Vector(this[0]*b.x+this[2]*b.y+this[4],this[1]*b.x+this[3]*b.y+this[5])},c.multiply=function(a){return new b([this[0]*a[0]+this[2]*a[1],this[1]*a[0]+this[3]*a[1],this[0]*a[2]+this[2]*a[3],this[1]*a[2]+this[3]*a[3],this[0]*a[4]+this[2]*a[5]+this[4],this[1]*a[4]+this[3]*a[5]+this[5]])},c.invert=function(){var b,c=new a.Matrix;return c[0]=this[3],c[1]=-this[1],c[2]=-this[2],c[3]=this[0],c[4]=this[2]*this[5]-this[3]*this[4],c[5]=-this[0]*this[5]+this[1]*this[4],b=this[0]*c[0]+this[2]*c[1],0==b?this.copy():(b=1/b,c[0]*=b,c[1]*=b,c[2]*=b,c[3]*=b,c[4]*=b,c[5]*=b,c)},c.copy=function(){var b=new a.Matrix;return b[0]=this[0],b[1]=this[1],b[2]=this[2],b[3]=this[3],b[4]=this[4],b[5]=this[5],b},c.set=function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this[4]=a[4],this[5]=a[5],this},c.setContextTransform=function(a){a.setTransform(this[0],this[1],this[2],this[3],this[4],this[5])}}(Tetragon),function(a){"use strict";var b=a.PointMass=function(b,c){this.p=b.copy(),this.pp=b.copy(),this.a=new a.Vector,this.mass=c||1,0==this.mass?this.invMass=Number.MAX_VALUE:this.mass==Number.MAX_VALUE?this.invMass=0:this.invMass=1/this.mass,this.damping=.997,this.pinned=!1},c=b.prototype;c.inertia=function(b){var c=.5*b*b,d=this.p.sub(this.pp).mult(this.damping),e=this.p.add(d.add(this.a.mult(c)));this.pp=this.p.copy(),this.p=e,this.a=new a.Vector},c.applyForce=function(a){this.a=this.a.add(a.mult(this.invMass))},c.pin=function(){this.pp=this.p.copy(),this.pinned=!0}}(Tetragon),function(a){"use strict";var b=a.Range=function(a,b){this.start=a||0,this.length=b||0},c=b.prototype;Object.defineProperty(c,"end",{enumerable:!0,get:function(){return this.start+this.length},set:function(a){this.length=a-this.start}}),c.containsPoint=function(a){return a>=this.start&&a<this.end},c.containsRange=function(a){return a.start>=this.start&&a.end<=this.end},c.intersectsWithRange=function(a){return a.start<this.end&&a.end>this.start}}(Tetragon),function(a){"use strict";var b=a.Rect=function(b,c){this.pos=b?b.copy():new a.Vector,this.size=c?c.copy():new a.Vector},c=b.prototype;Object.defineProperty(c,"maxPos",{enumerable:!0,get:function(){return this.pos.add(this.size)},set:function(a){this.size=a.sub(this.size)}}),c.containsPoint=function(a){var b=this.pos,c=this.maxPos;return a.x>=b.x&&a.x<c.x&&a.y>=b.y&&a.y<c.y?!0:!1},c.containsRect=function(a){var b=this.pos,c=this.maxPos,d=a.pos,e=a.maxPos;return d.x>=b.x&&e.x<c.x&&d.y>=b.y&&e.y<c.y?!0:!1},c.intersectsWithRect=function(a){var b=this.pos,c=this.maxPos,d=a.pos,e=a.maxPos;return e.x>b.x&&d.x<c.x&&e.y>b.y&&d.y<c.y?!0:!1}}(Tetragon),function(a){"use strict";var b=1,c=2,d=a.Canvas=function(b){b=a.extend({element:null,tick:function(){},draw:function(){},framerate:1/120,autoClear:!0,origin:new a.Vector(.5,.5),scale:null,autoSetHeight:/MSIE/.test(navigator.userAgent)},b),this.element=b.element,this.ctx=b.element.getContext("2d"),this.tick=b.tick,this.draw=b.draw,this.framerate=b.framerate,this.frameDelta=0,this.animationLoop=new a.AnimationLoop(this.framerate),this._viewport=new a.Rect,this._transform=null,this._inverseTrans=null,this._flags=0,this.options=b,b.autoClear&&(this._flags|=c)},e=d.prototype;Object.defineProperty(e,"viewport",{get:function(){var a=this.element,b=+a.width,c=+a.height;return this._viewport.size.x=b,this._viewport.size.y=c,this._viewport}}),Object.defineProperty(e,"transform",{get:function(){var b=this._transform;return b||(b=new a.Matrix,this.options.origin&&b.translate(this.options.origin.multVec(this.viewport.size)),this.options.scale&&b.scale(this.options.scale)),b},set:function(a){a&&(a=a.copy()),this._transform=a,this._transform.setContextTransform(this.ctx),this._flags|=b}}),Object.defineProperty(e,"inverseTransform",{get:function(){return this._flags&b&&(this._inverseTrans=this._transform.invert(),this._flags&=~b),this._inverseTrans||(this._inverseTrans=this.transform.invert()),this._inverseTrans.copy()}}),e._updateTransform=function(a){a=a||this.transform,a.setContextTransform(this.ctx)},e._tick=function(){var a=this,b=(new Date).getTime()/1e3;this.animationLoop.advanceToTime(b,function(){a.tick(a.framerate,{viewport:a.viewport})}),this.frameDelta=(b-this.animationLoop.lastTime)/this.animationLoop.framerate,this._draw(),this.animationFrame=window.requestAnimationFrame(function(){a._tick()})},e.clear=function(){var b=this.viewport.size,c=b.x,d=b.y;this.ctx.save(),this._updateTransform(new a.Matrix),this.ctx.clearRect(0,0,c,d),this._updateTransform(),this.ctx.restore()},e._draw=function(){this._flags&c&&this.clear(),this.ctx.save(),this._updateTransform(),this.draw.call(this,this.ctx,{viewport:this.viewport,frameDelta:this.frameDelta}),this.ctx.restore()},e.startAnimating=function(){var a=this;this.animationFrame||(this.animationFrame=window.requestAnimationFrame(function(){a._tick()}),this.options.autoSetHeight&&this._addResizeListener())},e.stopAnimating=function(){this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=null,this._removeResizeListener())},e.redraw=function(){this._draw()},e.offsetFromEvent=function(b){for(var c=this.element,d=c.offsetLeft,e=c.offsetTop;c=c.offsetParent;)d+=c.offsetLeft,e+=c.offsetTop;var f=new a.Vector(d,e),g=this.element.offsetWidth/this.element.width;if(b.changedTouches)f.x=b.changedTouches[0].pageX-f.x,f.y=b.changedTouches[0].pageY-f.y;else{var h=document.documentElement;f.x=b.clientX-f.x+h.scrollLeft,f.y=b.clientY-f.y+h.scrollTop}return f=f.mult(1/g)},e.worldPositionFromOffset=function(a){return this.inverseTransform.multVec(a)},e.offsetFromWorldPosition=function(a){return this.transform.multVec(a)},e._resizeEventHandler=null,e._addResizeListener=function(){var a=this;this._resizeEventHandler||(this._resizeEventHandler=function(){var b=a.element.parentNode,c=b.getBoundingClientRect(),d=a.element.height/a.element.width;a.element.style.height=parseInt(c.width*d)+"px"},window.addEventListener("resize",this._resizeEventHandler),window.addEventListener("orientationchange",this._resizeEventHandler),this._resizeEventHandler())},e._removeResizeListener=function(){this._resizeEventHandler&&(window.removeEventListener("resize",this._resizeEventHandler),window.removeEventListener("orientationchange",this._resizeEventHandler),this._resizeEventHandler=null)}}(Tetragon),function(a){"use strict";var b=a.Constraint=function(a,b,c,d){void 0===c&&(c=b.p.sub(a.p).length()),void 0===d&&(d=1),this.p1=a,this.p2=b,this.restDist=c,this.stiffness=d},c=b.prototype;c.solve=function(){var a=this.p1,b=this.p2,c=a.p.sub(b.p),d=c.length(),e=0;0!=d&&(e=(this.restDist-d)/d),c=c.mult(e);var f=1-a.mass/(a.mass+b.mass),g=f*this.stiffness,h=this.stiffness-g;a.pinned||(a.p=a.p.add(c.mult(g))),b.pinned||(b.p=b.p.sub(c.mult(h)))}}(Tetragon);
//# sourceMappingURL=tetragon.min.js.map