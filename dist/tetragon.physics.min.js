!function(a){"use strict";a.Tetragon=a.Tetragon||{version:"0.1.5"}}(window),function(a){"use strict";var b=a.PointMass=function(b,c){this.p=b.copy(),this.pp=b.copy(),this.a=new a.Vector,this.mass=c||1,0==this.mass?this.invMass=Number.MAX_VALUE:this.mass==Number.MAX_VALUE?this.invMass=0:this.invMass=1/this.mass,this.damping=.997,this.pinned=!1},c=b.prototype;c.inertia=function(b){var c=.5*b*b,d=this.p.sub(this.pp).mult(this.damping),e=this.p.add(d.add(this.a.mult(c)));this.pp=this.p.copy(),this.p=e,this.a=new a.Vector},c.applyForce=function(a){this.a=this.a.add(a.mult(this.invMass))},c.pin=function(){this.pp=this.p.copy(),this.pinned=!0}}(Tetragon),function(a){"use strict";var b=a.Constraint=function(a,b,c,d){void 0===c&&(c=b.p.sub(a.p).length),void 0===d&&(d=1),this.p1=a,this.p2=b,this.restDist=c,this.stiffness=d},c=b.prototype;c.solve=function(){var a=this.p1,b=this.p2,c=a.p.sub(b.p),d=c.length,e=0;0!=d&&(e=(this.restDist-d)/d),c=c.mult(e);var f=1-a.mass/(a.mass+b.mass),g=f*this.stiffness,h=this.stiffness-g;a.pinned||(a.p=a.p.add(c.mult(g))),b.pinned||(b.p=b.p.sub(c.mult(h)))}}(Tetragon),function(a){"use strict";var b=a.QuadTree=function(a){this.quads=[],this.quadFlags=0,this.items=[],this.rect=a.copy()},c=b.Quad=function(a,b,c){this.parent=a,this.idx=b,this.quads=[],this.quadFlags=0,this.items=[],this.rect=c.copy()},d=b.Item=function(a,b){this.quad=null,this.item=a,this.rect=b.copy()};d.prototype.remove=function(){var a,b,c=this.quad;for(a=c.items.indexOf(this),c.items.splice(a,1);c;c=b)b=c.parent,!b||c.items.length||c.quadFlags||(delete b.quads[c.idx],b.quadFlags&=~(1<<c.idx))},d.prototype.move=function(a){throw"unimplemented method move"},b.prototype.addItem=function(a,b){for(var e,f,g=this,a=new d(a,b);g;){if(f=g.rect.center,!g.items.length){a.quad=g,g.items.push(a);break}if(!g.rect.contains(b)){a.quad=g,g.items.push(a);break}if(b.pos.x+b.size.x<f.x)e=0;else{if(!(b.pos.x>=f.x)){a.quad=g,g.items.push(a);break}e=2}if(b.pos.y+b.size.y<f.y)e+=0;else{if(!(b.pos.y>=f.y)){a.quad=g,g.items.push(a);break}e+=1}if(!g.quads[e]){var h=g.rect.copy();switch(h.size.x*=.5,h.size.y*=.5,e){case 0:break;case 1:h.pos.y+=h.size.y;break;case 2:h.pos.x+=h.size.x;break;case 3:h.pos.x+=h.size.x,h.pos.y+=h.size.y}g.quads[e]=new c(g,e,h),g.quadFlags|=1<<e}g=g.quads[e]}return a},b.prototype.forEachItemInRect=function(a,b,c){var d;for(c=c||this,d=0;d<c.items.length;d++){var e=c.items[d];b.intersects(e.rect)&&a(e.item,e)}for(d=0;d<c.quads.length;d++){var f=c.quads[d];f&&b.intersects(f.rect)&&this.forEachItemInRect(a,b,f)}}}(Tetragon);
//# sourceMappingURL=tetragon.physics.min.js.map